const wss = new WebSocket("wss://existenz.fr.nf:3000/node/temperature");
console.log('ok');
wss.onmessage = function (event) {
	console.log('event : ', event.data)
};

async function addBottle(){
	console.log('add bottle');
	const response = await fetch('https://existenz.fr.nf/cellars/1', {
		method: 'get',
	})
	const resp = JSON.parse(await response.text());
	// console.log(JSON.parse(await response.text()));
	// les cases et leur etat	
	const places  = JSON.parse(resp.bottle_box);
	// la 1ere case dispo
	let free_place = getEmptyPlace(places);
	console.log(free_place)
	// appel fonction python : led s'allume , sonar en attente
	
}

function createMessage()
{]async function sendWSMessage(){
	const wss = new WebSocket("wss://existenz.fr.nf/node/addBottle")
	wss.send(message);
}

function getEmptyPlace(array){
	//console.log(array);
	//return array.find(element => element.bottle === null);
	let place_free = {};
	array.forEach(function(el, idx, elems){
	if(place_free.index === undefined && el.bottle === null) {
		place_free.index = idx;
		place_free.place = el;
	}
	});
	return place_free;
}
